require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_info/index"],{"460f":function(t,i,e){"use strict";e.r(i);var n=e("ebaf"),r=e("4de1");for(var a in r)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return r[t]}))}(a);e("f89c");var s=e("f0c5"),o=Object(s["a"])(r["default"],n["b"],n["c"],!1,null,"db6c4c5e",null,!1,n["a"],void 0);i["default"]=o.exports},"4de1":function(t,i,e){"use strict";e.r(i);var n=e("aff5"),r=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=r.a},"5a29":function(t,i,e){},"7de1":function(t,i,e){"use strict";(function(t,i){var n=e("4ea4");e("8824");n(e("66fd"));var r=n(e("460f"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(r.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},aff5:function(t,i,e){"use strict";(function(t){var n=e("4ea4");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r=e("99c8"),a=e("53c2"),s=(e("d5f7"),e("26cb")),o=(n(e("3013")),n(e("a29e"))),u={components:{},mixins:[o.default],data:function(){return{userInfo:{},loginType:"h5",userIndex:0,switchUserInfo:[],isAuto:!1,isShowAuth:!1,canvasWidth:"",canvasHeight:"",canvasStatus:!1,district:[],multiArray:[],multiIndex:[0,0,0],valueRegion:[0,0,0],region:["省","市","区"],mp_is_new:this.$Cache.get("MP_VERSION_ISNEW")||!1}},computed:(0,s.mapGetters)(["isLogin"]),watch:{isLogin:{handler:function(t,i){},deep:!0}},onLoad:function(){this.isLogin?this.getUserInfo():this.getIsLogin()},onShow:function(){t.removeStorageSync("form_type_cart")},methods:{getIsLogin:function(){this.isShowAuth=!0},addressList:function(){this.getCityList()},getCityList:function(){var t=this,i=this;(0,a.getCity)().then((function(e){t.district=e.data,i.initialize()}))},initialize:function(){var t=[],i=[],e=[];if(this.district.length){var n=this.district[0].c||[],r=n.length&&n[0].c||[];this.district.forEach((function(i){t.push(i.n)})),n.forEach((function(t){i.push(t.n)})),r.forEach((function(t){e.push(t.n)})),this.multiArray=[t,i,e]}},bindRegionChange:function(t,i){var e=this.multiIndex,n=this.district[e[0]]||{c:[]},r=n.c[e[1]]||{v:0},a=this.multiArray,s=t.detail.value;this.region=[a[0][s[0]],a[1][s[1]],a[2][s[2]]],this.userInfo.register_extend_info[i].value=r.v,this.userInfo.register_extend_info[i].province=this.region[0],this.userInfo.register_extend_info[i].city=this.region[1],this.userInfo.register_extend_info[i].district=this.region[2],this.valueRegion=[0,0,0],this.initialize()},bindMultiPickerColumnChange:function(t){var i=t.detail.column,e=t.detail.value,n=this.district[e]||{c:[]},r=this.multiArray,a=this.multiIndex;switch(a[i]=e,i){case 0:var s=n.c[0]||{c:[]};r[1]=n.c.map((function(t){return t.n})),r[2]=s.c.map((function(t){return t.n}));break;case 1:var o=this.district[a[0]].c[a[1]].c||[];r[2]=o.map((function(t){return t.n}));break;case 2:break}this.$set(this.multiArray,0,r[0]),this.$set(this.multiArray,1,r[1]),this.$set(this.multiArray,2,r[2]),this.multiIndex=a},radioChange:function(t,i){this.userInfo.register_extend_info[i].value=t.detail.value},bindDateChange:function(t,i){this.userInfo.register_extend_info[i].value=t.target.value},onLoadFun:function(){this.getUserInfo(),this.isShowAuth=!1},authColse:function(t){this.isShowAuth=t},Setting:function(){t.openSetting({success:function(t){}})},switchAccounts:function(i){var e=this,n=this.switchUserInfo[i],r=this;return r.userIndex=i,r.switchUserInfo.length<=1||(void 0===n?r.$util.Tips({title:"切换的账号不存在"}):void("h5"===n.user_type?(t.showLoading({title:"正在切换中"}),(0,a.switchH5Login)().then((function(i){t.hideLoading(),r.$store.commit("LOGIN",{token:i.data.token,time:e.$Cache.strTotime(i.data.expires_time)-e.$Cache.time()}),r.getUserInfo()})).catch((function(i){return t.hideLoading(),r.$util.Tips({title:i})}))):(r.$store.commit("LOGOUT"),t.showLoading({title:"正在切换中"}),this.getIsLogin())))},outLogin:function(){var i=this;"h5"==i.loginType&&t.showModal({title:"提示",content:"确认退出登录?",success:function(e){e.confirm?(0,r.getLogout)().then((function(e){i.$store.commit("LOGOUT"),t.reLaunch({url:"/pages/index/index"})})).catch((function(t){})):e.cancel}})},getUserInfo:function(){var t=this;(0,r.getUserInfo)().then((function(i){i.data.register_extend_info.forEach((function(t){"radio"==t.format?t.value="0":(t.value="","address"==t.format&&(t.province="",t.city="",t.district=""))})),i.data.register_extend_info.forEach((function(e){i.data.extend_info.forEach((function(i){if(e.info===i.info&&(e.value=i.value,"address"==e.format)){var n=[i.province,i.city,i.district];t.$set(t,"region",n)}}))})),t.$set(t,"userInfo",i.data);for(var e=i.data.switchUserInfo||[],n=0;n<e.length;n++)e[n].uid==t.userInfo.uid&&(t.userIndex=n);t.$set(t,"switchUserInfo",e)}))},uploadpic:function(){var t=this,i=this;this.canvasStatus=!0,i.$util.uploadImageChange("upload/image",(function(e){var n=i.switchUserInfo[i.userIndex];i.userInfo.avatar=e.data.url,i.switchUserInfo[i.userIndex]=n,i.$set(i,"switchUserInfo",i.switchUserInfo),t.canvasStatus=!1}),(function(i){t.canvasStatus=!1}),(function(i){t.canvasWidth=i.w,t.canvasHeight=i.h}))},onChooseAvatar:function(t){var i=this,e=t.detail.avatarUrl;this.$util.uploadImgs("upload/image",e,(function(t){i.userInfo.avatar=t.data.url}),(function(t){}))},formSubmit:function(t){var i=this,e=t.detail.value;i.switchUserInfo[i.userIndex];if(!e.nickname)return i.$util.Tips({title:"用户姓名不能为空"});e.avatar=this.userInfo.avatar;for(var n=0;n<i.userInfo.register_extend_info.length;n++){var a=i.userInfo.register_extend_info[n];if(a.required||a.value){if(("date"===a.format||"address"===a.format)&&!a.value)return i.$util.Tips({title:"".concat(a.tip)});if("text"===a.format&&!a.value.trim())return i.$util.Tips({title:"".concat(a.tip)});if("num"===a.format&&a.value<=0)return i.$util.Tips({title:"".concat(a.tip)});if("mail"===a.format){if(a.required&&!a.value)return i.$util.Tips({title:"".concat(a.tip)});if(a.value&&!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.value))return i.$util.Tips({title:"请填写正确的邮箱"})}if("phone"===a.format&&!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(a.value))return i.$util.Tips({title:"".concat(a.tip)});if("id"===a.format){if(a.required&&!a.value)return i.$util.Tips({title:"".concat(a.tip)});if(a.value&&!/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/i.test(a.value))return i.$util.Tips({title:"请填写正确的身份证号码"})}}}e.extend_info=i.userInfo.register_extend_info,(0,r.userEdit)(e).then((function(t){return i.$util.Tips({title:t.msg,icon:"success"})})).catch((function(t){return i.$util.Tips({title:t||"保存失败，您并没有修改"})}))}}};i.default=u}).call(this,e("543d")["default"])},ebaf:function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return r})),e.d(i,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},r=[]},f89c:function(t,i,e){"use strict";var n=e("5a29"),r=e.n(n);r.a}},[["7de1","common/runtime","common/vendor"]]]);