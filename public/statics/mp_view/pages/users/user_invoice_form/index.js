require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/users/user_invoice_form/index"],{"15e7":function(e,t,n){},"29f2":function(e,t,n){"use strict";var i=n("15e7"),o=n.n(i);o.a},"3e4c":function(e,t,n){"use strict";n.r(t);var i=n("ecb0"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},6197:function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("8824");i(n("66fd"));var o=i(n("f092"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},ca34:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var i=function(){var e=this.$createElement,t=(this._self._c,this.is_default.length);this.$mp.data=Object.assign({},{$root:{g0:t}})},o=[]},ecb0:function(e,t,n){"use strict";(function(e){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("99c8"),a=i(n("a29e")),r={components:{home:function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("d878"))}.bind(null,n)).catch(n.oe)}},mixins:[a.default],data:function(){return{invoiceTypeList:[{name:"增值税电子普通发票",value:"1",info:"纸质发票开出后将以邮寄形式交付"},{name:"增值税电子专用发票",value:"2",info:"纸质发票开出后将以邮寄形式交付"}],id:"",header_type:"1",type:"1",drawer_phone:"",name:"",duty_number:"",tell:"",address:"",bank:"",card_number:"",is_default:[],email:"",popupType:!1,typeName:"",urlQuery:"",from:"",specialInvoice:!0,order_id:""}},computed:{backUrl:function(){switch(this.from){case"order_confirm":return"/pages/goods/order_confirm/index".concat(this.urlQuery);default:return"/pages/users/user_invoice_list/index?from=invoice_form"}}},onLoad:function(e){var t=this;for(var n in e)switch(n){case"couponTitle":case"new":case"cartId":case"pinkId":case"couponId":case"addressId":this.urlQuery+="".concat(this.urlQuery?"&":"?").concat(n,"=").concat(e[n]);break;case"from":this.from=e[n];break;case"header_type":this.header_type=e[n];break;case"id":this.id=e[n],this.getInvoiceDetail();break;case"specialInvoice":"false"===e[n]&&(this.specialInvoice=!1);break}e.order_id&&(this.order_id=e.order_id);var i=this.invoiceTypeList.find((function(e){return e.value===t.type}));this.typeName=i.name},onShow:function(){e.removeStorageSync("form_type_cart")},methods:{getInvoiceDetail:function(){var t=this;e.showLoading({title:"加载中"}),(0,o.invoiceDetail)(this.id).then((function(n){e.hideLoading(),t.header_type=n.data.header_type.toString(),t.type=n.data.type.toString();var i=t.invoiceTypeList.find((function(e){return e.value===t.type}));t.typeName=i.name,t.name=n.data.name,t.drawer_phone=n.data.drawer_phone,t.email=n.data.email,t.duty_number=n.data.duty_number,t.bank=n.data.bank,t.card_number=n.data.card_number,t.address=n.data.address,t.tell=n.data.tell,t.is_default=n.data.is_default?[""]:[]})).catch((function(t){e.showToast({title:t,icon:"none"})}))},formSubmit:function(t){var n=this,i=t.detail.value;if(i.type=this.type,"1"===i.header_type){if(!i.name)return e.showToast({title:"请输入需要开具发票的姓名",icon:"none"});if(!i.drawer_phone)return e.showToast({title:"请输入您的手机号",icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(i.drawer_phone))return e.showToast({title:"请正确输入您的手机号",icon:"none"});if(!i.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(i.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"})}if("2"===i.header_type){if("1"===i.type){if(!i.name)return e.showToast({title:"请输入需要开具发票的企业名称",icon:"none"});if(!i.duty_number)return e.showToast({title:"请输入纳税人识别号",icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(i.duty_number))return e.showToast({title:"请正确输入纳税人识别号",icon:"none"});if(!i.drawer_phone)return e.showToast({title:"请输入您的手机号",icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(i.drawer_phone))return e.showToast({title:"请正确输入您的手机号",icon:"none"});if(!i.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(i.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"})}if("2"===i.type){if(!i.name)return e.showToast({title:"请输入需要开具发票的企业名称",icon:"none"});if(!i.duty_number)return e.showToast({title:"请输入纳税人识别号",icon:"none"});if(!/[0-9A-HJ-NPQRTUWXY]{2}\d{6}[0-9A-HJ-NPQRTUWXY]{10}/.test(i.duty_number))return e.showToast({title:"请正确输入纳税人识别号",icon:"none"});if(!i.drawer_phone)return e.showToast({title:"请输入您的手机号",icon:"none"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(i.drawer_phone))return e.showToast({title:"请正确输入您的手机号",icon:"none"});if(!i.email)return e.showToast({title:"请输入您的联系邮箱",icon:"none"});if(!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(i.email))return e.showToast({title:"请正确输入您的联系邮箱",icon:"none"});if(!i.bank)return e.showToast({title:"请输入您的开户银行",icon:"none"});if(!i.card_number)return e.showToast({title:"请输入您的银行账号",icon:"none"});if(!i.address)return e.showToast({title:"请输入您所在的企业地址",icon:"none"});if(!i.tell)return e.showToast({title:"请输入您的企业电话",icon:"none"})}}i.is_default=i.is_default.length,i.id=this.id,e.showLoading({title:"保存中"}),(0,o.invoiceSave)(i).then((function(t){var o=n;e.showToast({title:t.msg,icon:"success",success:function(){switch(o.from){case"order_confirm":var n="";n+=1==i.header_type?"个人":"企业",n+=1==i.type?"普通":"专用",n+="发票",o.id?e.navigateTo({url:"/pages/goods/order_confirm/index".concat(o.urlQuery,"&invoice_id=").concat(o.id,"&invoice_name=").concat(n)}):e.navigateTo({url:"/pages/goods/order_confirm/index".concat(o.urlQuery,"&invoice_id=").concat(t.data.id,"&invoice_name=").concat(n)});break;case"order_details":o.id?e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(o.order_id,"&invoice_id=").concat(o.id)}):e.navigateTo({url:"/pages/goods/order_details/index?order_id=".concat(o.order_id,"&invoice_id=").concat(t.data.id)});break;default:e.navigateTo({url:"/pages/users/user_invoice_list/index?from=invoice_form"});break}}})})).catch((function(t){e.showToast({title:t,icon:"none"})}))},callType:function(){this.popupType=!0},changeType:function(e){var t=e.detail.value,n=this.invoiceTypeList.find((function(e){return e.value===t}));"2"===t&&"1"===this.header_type&&(this.header_type="2"),this.typeName=n.name,this.type=t,this.popupType=!1},closeType:function(){this.popupType=!1},changeTitleType:function(e){this.header_type=e.detail.value,this.type="1"}}};t.default=r}).call(this,n("543d")["default"])},f092:function(e,t,n){"use strict";n.r(t);var i=n("ca34"),o=n("3e4c");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("29f2");var r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"7c862d94",null,!1,i["a"],void 0);t["default"]=s.exports}},[["6197","common/runtime","common/vendor"]]]);