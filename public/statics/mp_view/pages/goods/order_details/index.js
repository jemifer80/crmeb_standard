require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/order_details/index"],{"01f8":function(e,t,n){"use strict";var o=n("6598"),i=n.n(o);i.a},"11ca":function(e,t,n){"use strict";n.r(t);var o=n("674d"),i=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=i.a},"1cf0":function(e,t,n){},"3dd9":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var o={wQrcode:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/wmf-code/components/w-qrcode/index")]).then(n.bind(null,"eba6"))}},i=function(){var e=this,t=e.$createElement,n=(e._self._c,[4,5].includes(e.orderInfo.refund_type)),o=[4,5].includes(e.orderInfo.refund_type),i=Number(e.orderInfo.id),r=Number(e.orderInfo.paid),s=e.isGoodsReturn&&0==e.orderInfo.product_type?e.orderInfo.refund_img&&e.orderInfo.refund_img.length:null,a=e.isGoodsReturn&&0==e.orderInfo.product_type?e.orderInfo.refund_goods_img&&e.orderInfo.refund_goods_img.length:null,d=(parseFloat(e.orderInfo.total_price)+parseFloat(e.orderInfo.vip_true_price)).toFixed(2),u=e.orderInfo.pay_postage>0?parseFloat(e.orderInfo.pay_postage).toFixed(2):null,c=e.orderInfo.vip_true_price>0?parseFloat(e.orderInfo.vip_true_price).toFixed(2):null,f=e.orderInfo.coupon_id?parseFloat(e.orderInfo.coupon_price).toFixed(2):null,l=parseFloat(e.orderInfo.first_order_price),p=l>0?parseFloat(e.orderInfo.first_order_price).toFixed(2):null,_=e.orderInfo.use_integral>0?parseFloat(e.orderInfo.deduction_price).toFixed(2):null,h=e.__map(e.orderInfo.promotions_detail,(function(t,n){var o=e.__get_orig(t),i=parseFloat(t.promotions_price),r=i?parseFloat(t.promotions_price).toFixed(2):null;return{$orig:o,m3:i,g10:r}})),g=parseFloat(e.orderInfo.pay_price).toFixed(2),v=(0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund)&&0!=e.status.type?e.orderInfo.is_apply_refund&&0==e.orderInfo.refund_status&&e.cartInfo.length>1:null,m=(0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund)&&0!=e.status.type&&v?e.cartInfo.length:null,y=0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund?"express"==e.orderInfo.delivery_type&&3==e.status.class_status&&2==e.status.type&&!e.split.length:null,I=0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund?3==e.status.class_status&&!e.split.length:null,b=0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund?4==e.status.type&&!e.split.length||-2==e.status.type:null,x=0==e.isGoodsReturn||9==e.status.type||e.orderInfo.refund_type||e.orderInfo.is_apply_refund?[1,2,4].includes(e.orderInfo.refund_type)&&!e.orderInfo.is_cancel:null;e._isMounted||(e.e0=function(t){e.refund_close=!1},e.e1=function(t){e.aleartStatus=!1},e.e2=function(t){e.aleartStatus=!1},e.e3=function(t){e.moreBtn=!1}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:o,m0:i,m1:r,g2:s,g3:a,g4:d,g5:u,g6:c,g7:f,m2:l,g8:p,g9:_,l0:h,g11:g,g12:v,g13:m,g14:y,g15:I,g16:b,g17:x}})},r=[]},6598:function(e,t,n){},"674d":function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("79c7"),r=n("aed8"),s=n("99c8"),a=(o(n("e338")),n("d5f7"),n("26cb")),d=o(n("a29e")),u={components:{payment:function(){Promise.all([n.e("common/vendor"),n.e("components/payment/index")]).then(function(){return resolve(n("fb96"))}.bind(null,n)).catch(n.oe)},home:function(){Promise.all([n.e("common/vendor"),n.e("components/home/index")]).then(function(){return resolve(n("d878"))}.bind(null,n)).catch(n.oe)},invoicePicker:function(){n.e("pages/goods/components/invoicePicker/index").then(function(){return resolve(n("74a09"))}.bind(null,n)).catch(n.oe)},invoiceModal:function(){n.e("pages/goods/components/invoiceModal/index").then(function(){return resolve(n("e879"))}.bind(null,n)).catch(n.oe)},orderGoods:function(){n.e("components/orderGoods/index").then(function(){return resolve(n("7325"))}.bind(null,n)).catch(n.oe)},customForm:function(){n.e("components/customForm/index").then(function(){return resolve(n("cd04"))}.bind(null,n)).catch(n.oe)}},mixins:[d.default],data:function(){return{giveData:{give_integral:0,give_coupon:[]},giveCartInfo:[],config:{qrc:{code:"",size:300,level:4,bgColor:"#FFFFFF",border:{color:["#eee","#eee"],lineWidth:3},color:["#333","#333"]}},order_id:"",evaluate:0,cartInfo:[],pid:0,split:[],orderInfo:{system_store:{},_status:{}},system_store:{},isGoodsReturn:!1,status:{},refund_close:!1,isClose:!1,payMode:[{name:"微信支付",icon:"icon-weixinzhifu",value:"weixin",title:"使用微信快捷支付",payStatus:!0},{name:"余额支付",icon:"icon-yuezhifu",value:"yue",title:"当前可用余额：",number:0,payStatus:!0}],pay_close:!1,pay_order_id:"",totalPrice:"0",isAuto:!1,isShowAuth:!1,routineContact:0,express_num:"",invoice_func:!1,invoiceData:{},invoice_id:0,invChecked:"",moreBtn:!1,invShow:!1,aleartStatus:!1,special_invoice:!1,invList:[],userInfo:{},isReturen:""}},computed:(0,a.mapGetters)(["isLogin"]),onLoad:function(e){e.order_id&&(this.$set(this,"order_id",e.order_id),this.isReturen=e.isReturen),e.invoice_id&&(this.invoice_id=e.invoice_id)},onShow:function(){e.removeStorageSync("form_type_cart"),this.isLogin?(this.getOrderInfo(),this.getUserInfo()):this.isShowAuth=!0},onHide:function(){this.isClose=!0},onReady:function(){},methods:{onLoadFun:function(){this.getOrderInfo(),this.getUserInfo(),this.isShowAuth=!1},authColse:function(e){this.isShowAuth=e},getpreviewImage:function(t,n){e.previewImage({urls:n?this.orderInfo.refund_img:this.orderInfo.refund_goods_img,current:n?this.orderInfo.refund_img[t]:this.orderInfo.refund_goods_img[t]})},cancelRefundOrder:function(t){var n=this;e.showModal({title:"取消申请",content:"您确认放弃此次申请吗?",success:function(e){e.confirm&&(0,i.cancelRefundOrder)(n.order_id).then((function(e){return n.$util.Tips({title:"操作成功",icon:"success"},{tab:4,url:"/pages/users/user_return_list/index"})})).catch((function(e){return n.$util.Tips({title:e})}))}})},refundInput:function(){e.navigateTo({url:"/pages/goods/order_refund_goods/index?orderId="+this.order_id})},goGoodCall:function(){var e="/pages/extension/customer_list/chat?orderId=".concat(this.order_id,"&isReturen=").concat(this.isReturen);this.$util.getCustomer(this.userInfo,e)},openSubcribe:function(t){var n=t;e.showLoading({title:"正在加载"}),(0,r.openOrderRefundSubscribe)().then((function(t){e.hideLoading(),e.navigateTo({url:n})})).catch((function(){e.hideLoading()}))},onChangeFun:function(e){var t=e,n=t.action||null,o=void 0!=t.value?t.value:null;n&&this[n]&&this[n](o)},makePhone:function(){e.makePhoneCall({phoneNumber:this.system_store.phone})},showMaoLocation:function(){if(!this.system_store.latitude||!this.system_store.longitude)return this.$util.Tips({title:"缺少经纬度信息无法查看地图！"});e.openLocation({latitude:parseFloat(this.system_store.latitude),longitude:parseFloat(this.system_store.longitude),scale:8,name:this.system_store.name,address:this.system_store.address+this.system_store.detailed_address,success:function(){}})},payClose:function(){this.pay_close=!1},pay_open:function(){this.pay_close=!0,this.pay_order_id=this.orderInfo.order_id,this.totalPrice=this.orderInfo.pay_price},pay_complete:function(){this.pay_close=!1,this.pay_order_id="",e.navigateTo({url:"/pages/goods/order_pay_status/index?order_id="+this.orderInfo.order_id+"&msg=支付成功&type=3&totalPrice="+this.totalPrice}),this.getOrderInfo()},pay_fail:function(){this.pay_close=!1,this.pay_order_id=""},getUserInfo:function(){var e=this;(0,s.getUserInfo)().then((function(t){e.userInfo=t.data,e.payMode[1].number=t.data.now_money,e.$set(e,"payMode",e.payMode)}))},getOrderInfo:function(){var t=this,n=this;e.showLoading({title:"正在加载中"});var o="";o=n.isReturen?(0,i.getRefundOrderDetail)(this.order_id):(0,i.getOrderDetail)(this.order_id),o.then((function(o){var i=o.data._status._type;e.hideLoading(),n.giveData.give_coupon=o.data.give_coupon,n.giveData.give_integral=o.data.give_integral,n.$set(n,"orderInfo",o.data),n.$set(n,"pid",o.data.pid),n.$set(n,"split",o.data.split),n.$set(n,"evaluate",3==i?3:0),n.$set(n,"system_store",o.data.system_store),n.$set(n,"invoiceData",o.data.invoice),n.invoiceData&&(n.invoiceData.pay_price=o.data.pay_price),n.$set(n,"invoice_func",o.data.invoice_func),n.$set(n,"special_invoice",o.data.special_invoice),n.$set(n,"routineContact",Number(o.data.routine_contact_type));var r=o.data.cartInfo,s=[],a=[];r.forEach((function(e){1==e.is_gift?a.push(e):s.push(e)})),n.$set(n,"cartInfo",s),n.$set(n,"giveCartInfo",a),t.$nextTick((function(){n.config.qrc.code=n.orderInfo.verify_code})),0!=t.orderInfo.refund_status?t.isGoodsReturn=!0:t.isReturen=0,n.invoice_id&&!n.invoiceData&&(n.invChecked=n.invoice_id||"",t.invoiceApply()),n.payMode.map((function(e){"weixin"==e.value&&(e.payStatus=!!o.data.pay_weixin_open),"alipay"==e.value&&(e.payStatus=!!o.data.ali_pay_status),"yue"==e.value&&(e.payStatus=1==o.data.yue_pay_status)})),n.getOrderStatus()})).catch((function(t){e.hideLoading(),403==t.status?e.navigateTo({url:"/pages/goods/order_list/index"}):n.$util.Tips({title:t},"/pages/goods/order_list/index")}))},invCancel:function(){this.invChecked="",this.invTitle="不开发票",this.invShow=!1},invSub:function(t){var n=this;this.invChecked=t;var o={order_id:this.order_id,invoice_id:this.invChecked};(0,s.makeUpinvoice)(o).then((function(t){e.showToast({title:"申请成功",icon:"success"}),n.invShow=!1,n.aleartStatus=!0,n.getOrderInfo()})).catch((function(t){e.showToast({title:t,icon:"none"})}))},invClose:function(){this.invShow=!1,this.getInvoiceList()},invoiceApply:function(){this.getInvoiceList(),this.moreBtn=!1,this.invShow=!0},aleartStatusChange:function(){this.moreBtn=!1,this.aleartStatus=!0},getInvoiceList:function(){var t=this;e.showLoading({title:"正在加载…"}),(0,s.invoiceList)().then((function(n){e.hideLoading(),t.invList=n.data.map((function(e){return e.id=e.id.toString(),e}));var o=t.invList.find((function(e){return e.id==t.invChecked}));if(o){var i="";i+=1===o.header_type?"个人":"企业",i+=1===o.type?"普通":"专用",i+="发票",t.invTitle=i}})).catch((function(t){e.showToast({title:t,icon:"none"})}))},more:function(){this.moreBtn=!this.moreBtn},copy:function(){e.setClipboardData({data:this.orderInfo.order_id})},copyKm:function(){e.setClipboardData({data:this.orderInfo.virtual_info})},copyAddress:function(){e.setClipboardData({data:this.orderInfo._status.refund_name+this.orderInfo._status.refund_phone+this.orderInfo._status.refund_address,success:function(){e.Tips({title:"复制成功",icon:"success"})}})},goTel:function(){e.makePhoneCall({phoneNumber:this.orderInfo.delivery_id})},getOrderStatus:function(){var e=this.orderInfo||{},t=e._status||{_type:0},n={},o=parseInt(t._type),i=e.delivery_type,r=e.seckill_id?parseInt(e.seckill_id):0,s=e.bargain_id?parseInt(e.bargain_id):0,a=e.discount_id?parseInt(e.discount_id):0,d=e.combination_id?parseInt(e.combination_id):0;n={type:9==o?-9:o,class_status:0,class_again:0},1==o&&d>0&&(n.class_status=1),2==o&&"express"==i&&(n.class_status=2),2==o&&(n.class_status=3),4!=o&&0!=o||(n.class_status=4),r||s||d||a||e.type||3!=o&&4!=o||(n.class_status=5),r||s||d||a||e.type||1!=o&&2!=o&&5!=o||(n.class_again=6),this.$set(this,"status",n)},goJoinPink:function(){e.navigateTo({url:"/pages/activity/goods_combination_status/index?id="+this.orderInfo.pink_id})},goOrderConfirm:function(){var t=this;(0,i.orderAgain)(t.orderInfo.order_id).then((function(t){return e.navigateTo({url:"/pages/goods/order_confirm/index?new=1&cartId="+t.data.cateId})})).catch((function(e){return t.$util.Tips({title:e})}))},confirmOrder:function(t){var n=this;e.showModal({title:"确认收货",content:"为保障权益，请收到货确认无误后，再确认收货",success:function(e){e.confirm&&(0,i.orderTake)(t||n.order_id).then((function(e){return n.$util.Tips({title:"操作成功",icon:"success"},(function(){n.getOrderInfo()}))})).catch((function(e){return n.$util.Tips({title:e})}))}})},delOrder:function(){var t=this;e.showModal({title:"删除订单",content:"确定删除该订单",success:function(e){if(e.confirm)(t.isReturen?i.refundOrderDel:i.orderDel)(t.order_id).then((function(e){return t.status.type,t.$util.Tips({title:"删除成功",icon:"success"},{tab:3,url:1})})).catch((function(e){return t.$util.Tips({title:e})}));else if(e.cancel)return t.$util.Tips({title:"已取消"})}})},cancelOrder:function(){var t=this;e.showModal({title:"提示",content:"确认取消该订单?",success:function(n){n.confirm?(0,i.orderCancel)(t.orderInfo.order_id).then((function(t){var n=getCurrentPages(),o=n[n.length-3].$page.fullPath;e.reLaunch({url:o})})).catch((function(){t.getDetail()})):n.cancel}})}}};t.default=u}).call(this,n("543d")["default"])},"8f12":function(e,t,n){"use strict";n.r(t);var o=n("3dd9"),i=n("11ca");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("9a74"),n("01f8");var s=n("f0c5"),a=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"40a0fb8f",null,!1,o["a"],void 0);t["default"]=a.exports},"9a74":function(e,t,n){"use strict";var o=n("1cf0"),i=n.n(o);i.a},fc18:function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("8824");o(n("66fd"));var i=o(n("8f12"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["fc18","common/runtime","common/vendor"]]]);